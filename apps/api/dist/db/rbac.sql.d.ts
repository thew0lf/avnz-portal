export declare const RBAC_CHECK_SQL = "\nWITH target AS (SELECT path FROM authz.nodes WHERE id = $1),\nuser_roles AS (\n  SELECT MAX(r.level) AS max_level\n  FROM authz.role_assignments ra\n  JOIN authz.roles r ON r.id = ra.role_id\n  JOIN authz.nodes n ON n.id = ra.node_id\n  JOIN target t ON n.path @> t.path        -- ancestor-or-equal\n  WHERE ra.user_id = $2\n)\nSELECT ur.max_level AS user_level,\n       req.level    AS required_level,\n       (ur.max_level >= req.level) AS rbac_pass\nFROM authz.permissions p\nJOIN authz.roles req ON req.id = p.min_role_id\nJOIN user_roles ur ON true\nWHERE p.domain = $3\n  AND p.resource_type = $4\n  AND p.action_name = $5";
